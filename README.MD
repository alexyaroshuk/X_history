# X History Chrome Extension

A Chrome extension that tracks and saves X (Twitter) posts you view, with full-text search, masonry grid layout, and offline caching.

## üöÄ Features

- **Automatic Post Tracking**: Automatically saves posts you view on X.com
- **Smart Caching**: Posts cached in IndexedDB for instant loading and offline access
- **Full-Text Search**: Search through saved posts by content, username, or keywords
- **Dual View Modes**:
  - **Masonry Grid View**: Pinterest-style responsive grid layout
  - **List View**: Compact single-column layout
- **History Manager**: Dedicated page for managing your entire post history
- **Dark/Light Theme**: Automatic theme detection with manual toggle
- **Infinite Scroll**: Smooth pagination (10 posts per page in history, 5 in popup)
- **Import/Export**: Backup and restore your post history as JSON
- **TypeScript**: Full type safety and better development experience
- **Manifest V3**: Future-proof with Chrome's latest extension architecture

## üì¶ Tech Stack

- **React 19** - Modern UI framework with hooks
- **TypeScript** - Type-safe development
- **Vite 7** - Lightning-fast build tool and dev server
- **@crxjs/vite-plugin** - Chrome extension development with HMR
- **Tailwind CSS** - Utility-first CSS framework
- **shadcn/ui** - Accessible React component library (Button, Card, Input, ScrollArea)
- **Lucide React** - Icon library
- **Manifest V3** - Latest Chrome extension architecture
- **IndexedDB** - Local database for post caching with full-text search
- **FxTwitter API** - Enhanced post data with media, engagement stats, and metadata

## üõ†Ô∏è Installation

### For Users (Load Unpacked)

1. **Download** or clone this repository
2. **Install dependencies and build**:
   ```bash
   npm install
   npm run build
   ```
3. **Open Chrome** and navigate to `chrome://extensions/`
4. **Enable Developer Mode** (toggle in top right)
5. **Click "Load unpacked"** and select the `dist` folder
6. **Pin the extension** to your toolbar

> **Note**: This extension is distributed as "load unpacked" for maximum privacy and control. Your data stays completely local.

### For Developers

```bash
# Clone the repository
git clone https://github.com/yourusername/x-history.git
cd x-history

# Install dependencies
npm install

# Development mode with hot reload
npm run dev

# Build for production
npm run build

# Preview production build
npm run preview
```

**Development workflow:**
- `npm run dev` starts Vite dev server with HMR (Hot Module Replacement)
- Changes to React components auto-reload
- Extension reloads automatically with @crxjs/vite-plugin
- Build output goes to `dist/` folder

## üí° Usage

### Basic Operation

1. **Browse X.com** - Navigate and view posts normally
2. **Automatic Tracking** - Posts are automatically saved as you browse
3. **View History** - Click the extension icon to see recent posts
4. **History Manager** - Click üìã button for full history page

### Features Guide

#### üîç Search
- Real-time search as you type
- Searches post content, usernames, and metadata
- Multi-word search (all terms must match)
- Clear button to reset search

#### üé® View Modes
- **Grid View**: Masonry layout with multiple columns
- **List View**: Single column with compact cards
- Toggle between views with the grid/list buttons

#### üìä History Manager
- View all saved posts in one place
- Advanced filtering and sorting
- Export your data as JSON
- Import previously exported data
- Bulk management options

#### üé® Themes
- Automatic system theme detection
- Manual toggle with üåô/‚òÄÔ∏è button
- Persists across sessions

## üìÇ Project Structure

```
X_history/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ popup/             # Popup React app (500x600px)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html     # Popup entry HTML
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.tsx      # React root
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Popup.tsx      # Main popup component with infinite scroll
‚îÇ   ‚îú‚îÄ‚îÄ history/           # History page React app (full-page manager)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html     # History entry HTML
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.tsx      # React root
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ History.tsx    # Main history component with grid/list views
‚îÇ   ‚îú‚îÄ‚îÄ components/        # Shared React components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TweetCard.tsx  # Rich tweet display with media, engagement stats
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui/            # shadcn/ui components (button, card, input, scroll-area)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/             # React hooks
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useTweetData.ts # FxTwitter API hook with localStorage cache
‚îÇ   ‚îú‚îÄ‚îÄ utils/             # Utility functions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ enrichPosts.ts # Post enrichment utilities
‚îÇ   ‚îú‚îÄ‚îÄ background.ts      # Service worker (Manifest V3) - tracks x.com/*/status/*
‚îÇ   ‚îú‚îÄ‚îÄ db.ts              # IndexedDB operations with full-text search
‚îÇ   ‚îú‚îÄ‚îÄ sidebar.ts         # Legacy popup script (not used in React version)
‚îÇ   ‚îî‚îÄ‚îÄ index.css          # Global Tailwind styles
‚îú‚îÄ‚îÄ dist/                  # Vite build output (load this folder)
‚îú‚îÄ‚îÄ images/                # Extension icons (16, 48, 128)
‚îú‚îÄ‚îÄ manifest.json          # Manifest V3 config
‚îú‚îÄ‚îÄ vite.config.ts         # Vite configuration with @crxjs/vite-plugin
‚îú‚îÄ‚îÄ tailwind.config.js     # Tailwind configuration
‚îú‚îÄ‚îÄ tsconfig.json          # TypeScript configuration
‚îî‚îÄ‚îÄ package.json           # Dependencies
```

## üîß Development

### Key Technologies & Architecture

- **React 19** - Component-based UI with latest features and hooks
- **Vite 7** - Fast builds (~2s) and instant HMR
- **@crxjs/vite-plugin** - Chrome extension dev tools with hot reload
- **Tailwind CSS** - Utility-first styling with dark mode support
- **shadcn/ui** - Pre-built accessible components
- **Chrome Storage API** - Stores URLs array (`urls` key)
- **IndexedDB** - Caches full post data with text/username indices for search
- **FxTwitter API** - Fetches enhanced post metadata (no auth required)
- **Service Workers** - Background URL tracking via `webNavigation` API
- **localStorage** - Caches tweet data by post ID to reduce API calls

### Data Flow
1. **Background script** monitors x.com navigation ‚Üí saves URLs to chrome.storage
2. **Popup/History** loads URLs ‚Üí fetches from IndexedDB cache or FxTwitter API
3. **TweetCard** displays rich content with useTweetData hook ‚Üí caches in localStorage

## üîí Privacy

- **100% Local Storage** - All data stays in your browser (chrome.storage, IndexedDB, localStorage)
- **No External Servers** - Only connects to X.com (for tracking) and FxTwitter API (for enrichment)
- **No Analytics/Tracking** - No telemetry, no third-party trackers
- **No Authentication** - FxTwitter API requires no keys or login
- **Easy Data Removal** - Clear all data with one click (clears all storage layers)
- **Export Your Data** - Full control with JSON export/import
- **Open Source** - Inspect the code, modify as needed

## üêõ Troubleshooting

### Posts not being tracked?
- **Solution**: Ensure you're on `x.com` (not `twitter.com`)
- Check extension permissions in `chrome://extensions/`
- Look for navigation to URLs matching `x.com/{username}/status/{id}`
- Check background service worker logs in extension details

### Posts not showing rich content?
- **Solution**: FxTwitter API may be rate-limited or unavailable
- Posts will fallback to simple URL display
- Wait a few minutes and refresh
- Check browser console (F12) for API errors

### Search not finding posts?
- **Solution**: Search looks in IndexedDB cached posts only
- Posts must be viewed first (not just tracked) to be searchable
- Search is case-insensitive and matches text/username
- Try simpler search terms or reload posts

### Theme not applying?
- **Solution**: Check system theme preference
- Use manual theme toggle (üåô/‚òÄÔ∏è button)
- Theme preference saved in localStorage

### Import/Export issues?
- **Export** creates JSON with all post URLs and metadata
- **Import** only accepts valid JSON arrays
- Large imports (>1000 posts) may take 10-30 seconds
- Extension may be unresponsive during import

### Extension icon not showing?
- **Solution**: Pin the extension in Chrome toolbar
- Check if extension is enabled in `chrome://extensions/`
- Reload the extension

## ‚ö†Ô∏è Known Issues & Technical Debt

- **Dual Storage Systems**: Both `urls` array (chrome.storage) and `trackedPosts` (chrome.storage) exist with migration logic - consider consolidating
- **Legacy Code**: [sidebar.ts](src/sidebar.ts) contains old non-React popup implementation (kept for reference, not actively used)
- **API Rate Limits**: FxTwitter API has no documented rate limits but may throttle - implement exponential backoff if needed
- **Media Display**: Videos may not work for private/deleted posts
- **Pagination**: History page loads all posts at once - consider virtualizing for 10k+ posts

## üì¶ Distribution

This extension is designed for **load unpacked** distribution rather than Chrome Web Store:

### Why Load Unpacked?

- ‚úÖ **Privacy First** - No review process, no external oversight
- ‚úÖ **Full Control** - Users can inspect and modify code
- ‚úÖ **Instant Updates** - Just rebuild and reload
- ‚úÖ **No Restrictions** - Avoid Web Store policies and review delays
- ‚úÖ **Developer Friendly** - Perfect for power users and developers

### Sharing with Others

To share this extension:

1. **Build the extension:**
   ```bash
   npm install
   npm run build
   ```

2. **Package the dist folder:**
   ```bash
   # Create a zip of the dist folder
   cd dist
   zip -r ../x-history-extension.zip .
   ```

3. **Share instructions with users:**
   - Extract the zip file
   - Go to `chrome://extensions/`
   - Enable Developer Mode
   - Click "Load unpacked"
   - Select the extracted folder

### Optional: Chrome Web Store

If you want to publish to Chrome Web Store later:

1. Update `manifest.json` with proper icons and descriptions
2. Create promotional images (1280x800, 640x400, etc.)
3. Create a developer account ($5 one-time fee)
4. Submit for review (1-2 weeks initial review)

For now, load unpacked is recommended for this privacy-focused tool.

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## üìÑ License

MIT License - see LICENSE file for details

## üÜò Support

For issues or questions:
1. Check the troubleshooting section above
2. Open browser DevTools (F12) for error details
3. Create an issue on GitHub
4. Include console logs and steps to reproduce

---

**Note**: This extension requires Chrome/Edge with Manifest V3 support (Chrome 88+)